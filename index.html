<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <style>
      * {
        margin: 0px;
      }
      .dragBox {
        background-color: rgba(255, 105, 180, 0.5);
        display: flex;
        position: absolute;
        justify-content: center;
        align-items: center;
        color: white;
      }
    </style>
  </head>
  <body>
    <script>
      let isDragging = true;
      let startX, startY, endX, endY;

      // 커서 이동에 따라 생성된 box 태그의 너비, 높이, 시작점을 변경하는 함수 생성

      const boxHandler = (event) => {
        const boxes = document.querySelectorAll('.dragBox');
        const $box = boxes[boxes.length - 1];
        if (isDragging) {
          const endX = event.clientX;
          const endY = event.clientY;
          const width = Math.abs(endX - startX);
          const height = Math.abs(endY - startY);

          $box.style.width = `${width}px`;
          $box.style.height = `${height}px`;
          $box.style.left = `${Math.min(startX, endX)}px`;
          $box.style.top = `${Math.min(startY, endY)}px`;

          const area = Math.round(width * height);

          // 박스의 면적 표기하기
          $box.textContent = `${area}px`;
          // 면적 글자 크기 변경하기
          $box.style.fontSize = `${Math.min(width, height) * 0.15}px`;
        }
      };

      // 마우스가 눌렸을 때 box 태그를 생성하는 이벤트 핸들러

      document.addEventListener('mousedown', (event) => {
        isDragging = true;
        // 마우스가 눌렸을 때 시작 위치를 지정해주기
        startX = event.clientX;
        startY = event.clientY;

        // 마우스가 눌렸을 때 box 태그를 body에 추가
        const $box = document.createElement('p');
        $box.classList.add('dragBox');
        document.body.appendChild($box);

        document.addEventListener('mousemove', boxHandler);
      });

      // 마우스를 놓았을 때 box 태그의 변화를 그만 만드는 이벤트 핸들러
      // 새로운 box 를 만들기 위함
      document.addEventListener('mouseup', () => {
        isDragging = false;
      });
    </script>
  </body>
</html>
